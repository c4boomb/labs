\input{../common/head.tex}
\input{config.tex}
\usepackage{csvsimple}

\begin{document}

\import{1_title/}{title.tex}

\clearpage

\pagenumbering{gobble}
%\import{3_abstract/}{main.tex}

%\pagestyle{empty}
%\thispagestyle{empty}
%\tableofcontents

\clearpage
\pagenumbering{arabic}
\pagestyle{fancy}
\setcounter{page}{2}

\clearpage

\chapter{Данные}

В лабораторной работе используется набор данных Individual household comsumption Data Set, который можно загрузить из UCI-репозитория \cite{Lichman:2013}.


Этот архив содержит 2075259 измерений собранных с декабря 2006 года до ноября 2010 года (47 месяцев). Набор данных содержит недостающие значения в измерениях (около 1,25\% строк). Очищенный набор данных содержит 2049281 строку (измерение).


Обозначения:
\begin{itemize}
\item date: дата измерения в формате dd/mm/yyyy;
\item global\_active\_power: активная мощность, которую употребляет домохозяйство в минуту (усреднено) [кВт];
\item global\_reactive\_power: реактивная мощность, которую употребляет домохозяйство в минуту (усреднено) [кВт];
\item voltage: напряжение, усреднённое за минуту наблюдения [В];
\item global\_intensity: усреднённая сила тока для домохозяйства [А];
\item sub\_metering\_1: набор употредителей энергии №1 [Вт-час активной энергии], отвечает кухне, на которой машина для мытья посуды и микроволновка (электрической плиты нет, используется газовая);
\item sub\_metering\_2: набор употредителей энергии №2 [Вт-час активной энергии], отвечает прачечной, в которой работает стиральная машина, сушилка, холодильник и включен свет;
\item sub\_metering\_3: набор употредителей энергии №3 [Вт-час активной энергии], отвечает бойлеру и кондиционеру.
\end{itemize}


\chapter{Задание}
Выполнить все задания, используя как numpy array, так и dataframe, проанализовав часовые траты на выполнение процедур (профилировка времени выполнения), сделав выводы по поводу ситуаций, в которых имеет смысл отдать преимущество той или иной структуре данных. Выводы оформить отчётом с указанным временем выполнения и оценкой по 5-бальной шкале удобности выполнения операций отбора.


Также необходимо оставить только те наблюдения, в которых нет пустых наблюдений (пустые значения --- пустые поля между разделителем --- ? --- 28.04.2007, как пример).

Задания:
\begin{enumerate}
\item выбрать все домохозяйства, в которых общая активная употребляемая мощность превышает 5 кВт;
\item выбрать все домохозяйства, в которых вольтаж превышает 235 В;
\item выбрать все домохозяйства, в которых сила тока лежит в пределах 19-20 А, для них обнаружить те, в которых стиральная машина и холодильник употребляют больше, чем бойлер и кондицинер;
\item выбрать случайным образом 500000 домохозяйств (без повторов элементов выборки), для них вычислить средние величины всех 3-х групп употребления электрической энергии;
\item выбрать те домохозяйства, которые после 18-00 употребляют больше 6 кВт за минуту в среднем, среди отобранных определить те, у которых основное употребление электроэнергии в указанный промежуток времени приходится на стиральную машину, сушилку, холодильник и освещение (группа 2 является самой большой), а потом выбрать каждый второй результат из первой половины и каждый четвёртый результат из второй половины.
\end{enumerate}

\chapter{Листинг кода}
Листинг кода с использованием dataframe
\lstset{inputencoding=utf8, extendedchars=\true}
\lstinputlisting[language=python,
                 basicstyle=\ttfamily\scriptsize]{source/lab3_df.py}

Листинг кода с использованием numpy array
\lstset{inputencoding=utf8, extendedchars=\true}
\lstinputlisting[language=python,
                 basicstyle=\ttfamily\scriptsize]{source/lab3_np.py}

\chapter{Анализ}

На \ref{time:df} изображено время выполнения функций с использованием dataframe. Названия строк --- функции, используемые для выполнения задания. <<Чтение файла>> -- время, за которое из csv-файла считываются данные и заносятся в dataframe или numpy array. <<Функция>> --- время, за которое выполняется функция. Так как в каждой функции используется функция считывания данных из файла, то есть смысл показать, сколько времени выполняется функция без создания dataframe или numpy array из csv-файла --- <<Чтение файла -- Функция>>. Всё время приведено в секундах. В последней строке находится только одно значение --- это среднее время считывания данных из файла и создания из него структуры данных (среднее время <<Чтение файла>>)

\begin{table}[h]
  \centering
  \csvreader[tabular=|l|l|l|c|,
  table head=\hline Время & Чтение файла & Функция & Чтение файла -- Функция \\\hline,
  late after line=\\\hline]
  {source/time_df.csv}{time=\time,read=\tread,function=\function,functionread=\functionread}
  {\time & \tread & \function & \functionread}

  \caption{Время для dataframe}
  \label{time:df}
\end{table}

На \ref{time:np} изображено время выполнения функций с использованием numpy array (обозначения аналогичны \ref{time:df}).

\begin{table}[h]
  \centering
  \csvreader[tabular=|l|l|l|c|,
  table head=\hline Время & Чтение файла & Функция & Чтение файла - Функция \\\hline,
  late after line=\\\hline]
  {source/time_np.csv}{time=\time,read=\tread,function=\function,functionread=\functionread}
  {\time & \tread & \function & \functionread}

  \caption{Время для numpy array}
  \label{time:np}
\end{table}



\chapter*{Выводы}
\addcontentsline{toc}{chapter}{Выводы}

В csv-файле, используемом в лабораторной работе, содержатся данные разных типов (числа с плавающей точком, дата, время, строка), поэтому при считывании из него в numpy array возникли трудности. Поэтому работа с dataframe оказалась удобнее. Время, которое тратится на создание numpy array из csv-файла меньше чем время, необходимое на создание dataframe из того же файла. Время выполнения функций получилось больше при использовании numpy array. Стандартные функции для создания выборок у двух рассматриваемых структур данных похожи. Обращение к элементам выборки в dataframe используется с использованием названия колонок, а в numpy array с использованием индексов. Pandas --- это инструмент, который обеспечивает более удобный и рациональный способ работы с табличными данными в Python. Я бы оценила работу с dataframe в 5 баллов, а с numpy array в 4 балла из 5. 


\clearpage
\phantomsection
\addcontentsline{toc}{chapter}{Список литературы}
\renewcommand\bibname{Список литературы}
\bibliography{bibliography.bib}

\end{document}
